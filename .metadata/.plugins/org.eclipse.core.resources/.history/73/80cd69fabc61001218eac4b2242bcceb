import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.io.UnsupportedEncodingException;
import java.net.URL;
import java.util.ArrayList;

import com.bigfatgun.fixjures.Fixjure;
import com.bigfatgun.fixjures.json.JSONSource;



public class three {

	/**
	 * @param args
	 * @throws IOException 
	 * @throws UnsupportedEncodingException 
	 * @throws ParseException 
	 */
	public static void main(String[] args) throws UnsupportedEncodingException, IOException {
		try {
			System.out.print("Search result 4: " + args[0] + "\n");
			
			URL url = new URL("http://search.twitter.com/search.json?rpp=3&q=" + args[0]);
			BufferedReader reader = null;

			String callback = new String();
			
			try {
			    reader = new BufferedReader(new InputStreamReader(url.openStream(), "UTF-8"));

			    for (String line; (line = reader.readLine()) != null;) {
			    	callback += line;
			    }
			    //System.out.println(
			    //		  "\n**************RAW*************************************\n"
			    //		+ callback 
			    //		+ "\n************END*RAW***********************************\n");
			
			    tweetData qtweetData = Fixjure.of(tweetData.class).from(JSONSource.newJsonString(callback)).create();
			    //ArrayList<tweetDetails> results = qtweetData.getResults(); // name now .equals("foo name");
			    String results_str = qtweetData.getResults();
			    //ArrayList results_arr = Fixjure.of(ArrayList.class).from(JSONSource.newJsonString(results_str)).create();
			    /*for(String result : results_arr) {
			    	System.out.println("result: " + result + "\n");
			    }*/
			    
			    results_str = results_str.replace("},{", "}01g4pk3y01{");
			    results_str = results_str.replace(",\"metadata\":{\"result_type\":\"recent\"}", "");
			    results_str = results_str.replace("\"geo\": null,", "");
			    results_str = results_str.replace("\"to_user_name\": null,", "");
			    results_str = results_str.replace("\"to_user\": null,", "");
			    String[] tmp = results_str.split("01g4pk3y01");
			    
			    //System.out.println("result: " + results_str);
			    
			    //String str = "one.two.three";
			    //String delimiter = "\\.";
			    //String[] temp = str.split(delimiter);
			    
			    tmp[0] = tmp[0].substring(1, tmp[0].length());
			    //System.out.println("tmp_arr length: " + tmp.length);
			    tmp[tmp.length - 1] = tmp[tmp.length - 1].substring(0, tmp[tmp.length - 1].length() - 1);
			    //for(int i = 0; i < tmp.length ; i++) {
			    String tt = tmp[0];
			    String query = "{"
   + "\"text\": \"RT @DrakeKnowledge: Put your boobs back in your shirt, smile instead of doing that duck face and put your middle finger down. Have some self-respect.\","
   + "\"from_user_id\": 912803580,"
   + "\"from_user_name\": \"Danielle Russo\","
//   + "\"geo\": null,"
   + "\"profile_image_url_https\": \"https://si0.twimg.com/profile_images/3042623638/932a576977975f8221b70809b7a58d97_normal.jpeg\","
   + "\"iso_language_code\": \"en\","
//   + "\"to_user_name\": null,"
   + "\"to_user_id\": 0,"
   + "\"id\": 292376125865332740,"
   + "\"to_user_id_str\": \"0\","
   + "\"source\": \"&lt;a href=&quot;http://twitter.com/download/iphone&quot;&gt;Twitter for iPhone&lt;/a&gt;\","
   + "\"from_user_id_str\": \"912803580\","
   + "\"from_user\": \"daanielle_russo\","
   + "\"created_at\": \"Fri, 18 Jan 2013 21:01:15 +0000\","
//   + "\"to_user\": null,"
   + "\"id_str\": \"292376125865332736\","
   + "\"profile_image_url\": \"http://a0.twimg.com/profile_images/3042623638/932a576977975f8221b70809b7a58d97_normal.jpeg\""
   + "}";
			    	tweetDetails qtweetDetails = Fixjure.of(tweetDetails.class).from(JSONSource.newJsonString(tmp[0])).create();
			    	String text = qtweetDetails.getText();
			    
			    	//tmp[i]= results_str.replace("},{", "}01g4pk3y01{");
			     	System.out.println("Text: " + text);
			    //}
			    
			} finally {
			    if (reader != null) try { reader.close(); } catch (IOException ignore) {}
			}
			
		} catch(ArrayIndexOutOfBoundsException e) {
			System.out.print("(.)(.)");
		}
	}
}
